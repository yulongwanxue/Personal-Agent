{"url": "C:\\Users\\33380\\AppData\\Local\\Temp\\gradio\\909df94e854551a3c85778806c7b23185d76137ad9ce10d1f1184f30dbcd4599\\NeurIPS-2018-masking-a-new-perspective-of-noisy-supervision-Paper.pdf", "raw": [{"content": "Masking: A New Perspective of Noisy Supervision\n\nBo Han∗1,2, Jiangchao Yao∗3,1, Gang Niu2, Mingyuan Zhou4,\nIvor W. Tsang1, Ya Zhang3, Masashi Sugiyama2,5\n1Centre for Artiﬁcial Intelligence, University of Technology Sydney\n2Center for Advanced Intelligence Project, RIKEN\n3Cooperative Medianet Innovation Center, Shanghai Jiao Tong University\n4McCombs School of Business, The University of Texas at Austin\n5Graduate School of Frontier Sciences, University of Tokyo\n\nAbstract\n\nIt is important to learn various types of classiﬁers given training data with noisy\nlabels. Noisy labels, in the most popular noise model hitherto, are corrupted from\nground-truth labels by an unknown noise transition matrix. Thus, by estimating\nthis matrix, classiﬁers can escape from overﬁtting those noisy labels. However,\nsuch estimation is practically difﬁcult, due to either the indirect nature of two-step\napproaches, or not big enough data to afford end-to-end approaches. In this paper,\nwe propose a human-assisted approach called “Masking” that conveys human cog-\nnition of invalid class transitions and naturally speculates the structure of the noise\ntransition matrix. To this end, we derive a structure-aware probabilistic model\nincorporating a structure prior, and solve the challenges from structure extraction\nand structure alignment. Thanks to Masking, we only estimate unmasked noise\ntransition probabilities and the burden of estimation is tremendously reduced. We\nconduct extensive experiments on CIFAR-10 and CIFAR-100 with three noise\nstructures as well as the industrial-level Clothing1M with agnostic noise struc-\nture, and the results show that Masking can improve the robustness of classiﬁers\nsigniﬁcantly.\n\n1\n Introduction\n\nIt is always challenging to learn from noisy labels [2, 34, 4, 37, 25], since these labels are systemati-\ncally corrupted. As a negative effect, noisy labels inevitably degenerate the accuracy of classiﬁers.\nThis negative effect becomes more prominent for deep learning, since these complex models can fully\nmemorize noisy labels, which correspondingly degenerates their generalization [48]. Unfortunately,\nnoisy labels are ubiquitous and unavoidable in our daily life, such as web queries [24], social-network\ntagging [6], crowdsourcing [45], medical images [8], and ﬁnancial analysis [1].\n\nTo handle such noisy labels, recent approaches explore three directions mainly. One direction focuses\non training only on selected samples, which leverages the sample-selection bias [18] to overcome\nthe label noise issue. For example, MentorNet [19] trains on “small-loss” samples. Meanwhile,\nDecoupling [26] trains on “disagreement” samples, for which the predictions of two networks\ndisagree. However, since the data for training are selected on the ﬂy rather than selected in the\nbeginning, it is hard to characterize these sample-selection biases, and then it is hard to give any\ntheoretical guarantee on the consistency of learning.\n\nAnother direction develops regularization techniques, including explicit and implicit regularizations.\nThis direction employs the regularization bias to overcome the label noise issue. Explicit regulariza-\n\n∗The ﬁrst two authors (Bo Han and Jiangchao Yao) made equal contributions. The implementation is available\n\nat https://github.com/bhanML/Masking.\n 32nd Conference on Neural Information Processing Systems (NeurIPS 2018), Montréal, Canada.\n\ntion is added to the objective function, such as manifold regularization [5] and virtual adversarial\ntraining [30]. Implicit regularization is designed for training algorithms, such as temporal ensem-\nbling [20] and mean teacher [41]. Nevertheless, both approaches introduce a permanent regularization\nbias, and the learned classier barely reaches the optimal performance [9].\n\nThe last direction estimates the noise transition matrix without introducing sample-selection bias\nand regularization bias. As an approximation of real-world corruption, noisy labels are theoretically\nﬂipped from the ground-truth labels by an unknown noise transition matrix. In this approach, the\naccuracy of classiﬁers can be improved by estimating this matrix accurately. The previous methods\nfor estimating the noise transition matrix can be roughly summarized into two solutions.\n\nOne solution estimates the noise transition matrix in advance, and subsequently learns the classiﬁer\nbased on this estimated matrix. For example, Patrini et al. [32] leveraged a two-step solution to\nestimate the noise transition matrix. The beneﬁt is to require limited data only for the estimation\nprocedure. Nonetheless, their method is too heuristic to estimate the noise transition matrix accurately.\n\nThe other solution jointly estimates the noise transition matrix and learns the classiﬁer in an end-to-\nend framework. For instance, on top of the softmax layer, Sukhbaatar et al. [39] added a constrained\nlinear layer to model the noise transition matrix, while Goldberger et al. [10] added a nonlinear\nsoftmax layer. The beneﬁt is the generality of their uniﬁed learning framework. However, their\nbrute-force learning leads to inexact estimation due to a ﬁnite dataset.\n\nTherefore, an important question is, with a ﬁnite dataset, can we leverage a constrained end-to-end\nmodel to overcome the above deﬁciencies? In this paper, we present a human-assisted approach\ncalled “Masking”. Masking conveys human cognition of invalid class transitions (i.e., cat  car),\nand speculates the structure of the noise transition matrix. The structure information can be viewed\nas a constraint to improve the estimation procedure. Namely, given the structure information, we can\nfocus on estimating the noise transition probability along the structure, which reduces the estimation\nburden largely.\n\nTo instantiate our approach, we derive a structure-aware probabilistic model, by incorporating a\nstructure prior. In the realization, we encounter two practical challenges: structure extraction and\nstructure alignment. Speciﬁcally, to address the structure extraction challenge, we propose a tempered\nsigmoid function to simulate the human cognition on the structure of the noise transition matrix. To\naddress the structure alignment challenge, we propose a variant of Generative Adversarial Networks\n(GANs) [12] to avoid the difﬁculty of specifying the explicit distributions. We conduct extensive\nexperiments on two benchmark datasets (CIFAR-10 and CIFAR-100) with three noise structures, and\nthe industrial-level dataset (Clothing1M[46]) with agnostic noise structure. The experimental results\ndemonstrate that the proposed approach can improve the robustness of classiﬁers signiﬁcantly.\n\n2 A new perspective of noisy supervision\n\nIn this section, we explore the noisy supervision from a brand new perspective, namely the structure\nof the noise transition matrix. First, we discuss where noisy labels normally come from, and why\nwe can speculate the structure of the noise transition matrix. Then, we present the representative\nstructures of the noise transition matrix.\n\nIn practice, noisy labels mainly come from the interaction between humans and tasks, such as\nsocial-network tagging and crowdsourcing. Assume that the more complex the interaction is, the\nmore efforts human beings spend. Due to cognitive psychology [29], human cognition can mask\ninvalid class transitions, and highlight valid class transitions automatically. This denotes that, human\ncognition can speculate the structure of the noise transition matrix correspondingly.\n\nOne effort-saving interaction is that, you tag a cluster of scenery images in social networks, such\nas beach, prairie, and mountain. However, the foreground of some images appears a dog or a cat,\nyielding noisy labels [35]. Thus, human cognition masks invalid class transitions (i.e., beach \nmountain), and highlights valid class transitions (i.e., beach\ndog). This noise structure should be\nthe diagonal matrix coupled with two column lines, namely a column-diagonal matrix (Figure 1(a)),\nwhere the column lines correspond to the dog and cat classes, respectively.\n ↔\n 2\n\n(a) Column-diagonal\n (b) Tri-diagonal\n (c) Block-diagonal\n\nFigure 1: Three types of noise structure. Vertical axis denotes the class of ground-truth label, while\nhorizontal axis denotes the class of noisy label. White block means the valid class transitions, while\nblack block means the invalid class transitions.\n\nAnother effort-consuming interactions stem from the task annotation on Amazon Mechanical Turk 2.\nEven with high-degree efforts, amateur workers may be potentially confused by very similar classes\nto yield noisy labels, due to their limited expertise. There are two practical cases.\n\nThe ﬁne-grained case denotes that, the transition from one class to its similar class is continuous (e.g.,\nAustralian terrier, Norfolk terrier, Norwich terrier, Irish terrier, and Scotch terrier), and workers make\nmistakes in the adjacent positions [7]. Thus, human cognition can mask invalid class transitions (i.e.,\nAustralian terrier  Norwich terrier), and highlight valid class transitions (i.e., Norfolk terrier\nNorwich terrier\n\n↔\nIrish terrier). This noise structure should be a tri-diagonal matrix (Figure 1(b)).\n\nThe hierarchical-grained case denotes that, the transition among super-classes is discrete (e.g., aquatic\nmammals and ﬂowers) and impossible, while the transition among sub-classes is continuous (e.g.,\naquatic mammals contain beaver, dolphin, otter, seal, and whale) and possible [32]. Thus, human\ncognition can mask invalid class transitions (i.e., aquatic mammals  ﬂowers), and highlight valid\ndolphin). This noise structure should be a block-diagonal matrix\nclass transitions (i.e., beaver\n(Figure 1(c)), where each block represents a super-class.\n ↔\n ↔\n\nWhen we already know the noise structure from human cognition, we only focus on estimating the\nnoise transition probability. However, how can we instill the structure information into the estimation\nprocedure? We are going to answer this question in the following sections.\n\n3 Learning with Masking\n\nWe brieﬂy show how benchmark models handle noisy labels, and reveal their deﬁciencies (Section 3.1).\nThen, we show why the Masking approach can solve such issues (Section 3.2). After the Masking\nprocedure, we present a straightforward idea to incorporate the structure information, and show\nits potential dilemma (Section 3.2.1). Fortunately, we ﬁnd a suitable approach to incorporate the\nstructure information into an end-to-end model (Section 3.2.2). To realize this approach, we encounter\ntwo practical challenges, and present principled solutions (Section 3.2.3).\n 3.1 Deﬁciency of benchmark models\n\nFigure 2(a) is a basic model to train a classiﬁer in the setting of noisy labels. Assuming that x\nrepresents a “Dog” image, its latent ground-truth label y should be a “Dog” class. However, its\nannotated label ˜y belongs to the “Cat” class. In essence, the noisy label ˜y is ﬂipped from the ground-\ntruth label y by an unknown noise transition matrix. Therefore, current techniques tend to improve\nthe accuracy of classiﬁer (x\n y) by estimating the noise transition matrix (y\n ˜y).\n →\n →\n\nHere, we introduce two benchmark realizations of Figure 2(a). The ﬁrst benchmark model comes\nfrom Patrini et al. [32], which uses the anchor set condition [21] to independently estimate the noise\n\n2https://www.mturk.com/\n\n3\n\n(a) Benchmark model.\n (b) MASKING model.\n\nFigure 2: Comparison of benchmark models and our MASKING model. Assume that, (x, ˜y) denotes\nthe instance with the noisy label, and y represents the latent ground-truth label. T is the noise\ntransition matrix, where Tij = Pr(˜y = ej\ny = ei). Left Panel: a benchmark model. Right Panel:\n|\nMASKING models the matrix T by an explicit variable s. Thus, we embed a structure constraint on\nthe variable s, where the structure information come from human cognition h.\n\n→\n ˜y). Based on the estimated matrix, they learn the classiﬁer (x\n\ntransition matrix (y\ny) by\nthe strategy of loss corrections. However, the estimation phase is not justiﬁed for agnostic noisy\ndata, which thus limits the performance of the classiﬁer. The other benchmark model comes from\nGoldberger and Ben-Reuven [10], which uniﬁes the two steps of the ﬁrst benchmark model into a\njoint fashion. Speciﬁcally, the noise transition matrix (y\n˜y) modeled by a nonlinear softmax layer\nconnects the classiﬁer (x\ny) with noisy labels ˜y for the end-to-end training. However, due to a\nﬁnite dataset, this brute-force estimation may suffer from many local minima.\n →\n →\n →\n 3.2 Does structure matter?\n\nTherefore, given a ﬁnite dataset, can we leverage a constrained end-to-end model to solve the above\ndeﬁciencies? The answer is afﬁrmative. The reason can be explained intuitively: when human\ncognition masks the invalid class transitions (i.e., cat  car), the structure information is available\nas the constraint. The constrained end-to-end model only focuses on estimating the noise transition\nprobability. The estimation burden will be largely reduced, and thus the brute-force estimation can\nﬁnd a good local minimum more easily.\n\nIn this paper, we summarize this human-assisted approach as “Masking”. Intuitively, with high\nprobability, Masking means some class transitions will not happen (i.e., cat  car), while some class\ntransitions will happen (i.e., beaver\ndolphin). Before delving into our realization, we ﬁrst present\na straightforward idea to incorporate the structure information into an end-to-end model as follows.\n ↔\n 3.2.1 Straightforward dilemma\n\nFor structure instillation, the most straightforward idea is to add a regularizer on the objective of\nan end-to-end model. Namely, we can use a regularizer to represent the structure constraint. Due\nto the regularization effect in the optimization [11], the noise transition matrix learned by previous\nmodels [32, 10] will satisfy our expectation regarding the structure. For example, we can apply the\nLagrange multiplier in the benchmark model from [10] to instantiate this idea.\n\nHowever, such a deterministic method may not be easily implemented in practice due to three reasons.\nFirst, such a class of regularizers requires a suitable distance measure to compute the distance between\nthe learned transition matrix and the prior, and the corresponding regularization parameter. In deep\nlearning scenarios, it is quite hard to justify the choice of a distance measure, e.g., why choosing L2\ndistance instead of other distance measures for the structure instillation. Second, if we leverage a\nnoisy validation set, we need to construct the unbiased risk estimator for the backward correction.\nThis is impossible, as the inverse of estimated noise transition matrix cannot be accurately computed.\n\nLast but not least, even though we construct a clean validation set, it needs to repeat the training\nprocedure to tune the regularization parameter, which consumes remarkable computational resources.\nSpeciﬁcally, it requires a lot of non-trivial trials in the training-validation phase to ﬁnd an optimal\nweight. For example, the Residual-52 net will take about one week to be well trained on the\nWebVision dataset, consisting of 16 million images with noisy labels [21]. If we consider adding a\n 4\n\nregularizer to instill structure information, each trial for adjusting the weight is a disaster. To sum up,\nwe do not consider this straightforward regularization approach.\n 3.2.2 When structure meets generative model\n\nBased on the previous discussions, we conjecture that the Bayesian method should be a more suitable\ntool to model the structure information, since the structure information can be explicitly represented\nas the prior. Following this conjecture, we deduce an end-to-end probabilistic model to incorporate\nthe structure information as shown in Figure 2(b).\n\nCompared to benchmark models in Figure 2(a), we model the noise transition matrix with a random\nvariable s, and we instill the structure information by controlling the prior of its corresponding\nstructure variable, termed as so. Here, we assume there exists a deterministic function f (\n) such\n·\nthat so = f (s). The reason that we make such an assumption can be intuitively explained with the\nobservation, once one arbitrary matrix is given, human cognition can certainly describe its structure,\ne.g., diagonal or tri-diagonal. Thus, there must be a function that can implement the mapping from\ns to its structure so. For clarity, we present an exemplar generative process for “multi-class” &\n“single-label” classiﬁcation problem with noisy supervision.\n\nx), where P (y\n|\n\nThe latent ground-truth label y\nThe noise transition matrix s\nP (so), where P (s) is an\nimplicit distribution modeled by neural networks without the exact form (i.e., multi-Dirac\ndistribution), P (so) = P (s) ds\ndso\nThe noisy label ˜y\n\nP (y\nP (s) and its structure so ∼\n\n) is the mapping function from s to so.\n·\n\ny, s) models the transition from y to ˜y given s.\ny, s), where P (˜y\nP (˜y\n|\n|\n\nx) is a Categorical distribution 3.\n\n, and f (\n\nso=f (s)\n\n∼\n∼\n ∼\n |\n\n\n\n\n•\n•\n •\n\nAccording to the above generative process, we can deduce the following evidence lower bound\n(ELBO) (the details in Appendix A) to approximate the log-likelihood of the noisy data, which can\nbe named as MASKING. MASKING is a structure-aware probabilistic model:\n\n\n\n\nln P (˜y\n|\n x)\n ≥\n E\n\nQ(s)\n\n\n ln\n y, s)P (y\n\nP (˜y\n|\n\nx)\n|\n −\n\nln \n Q(so)/ P (so)\n \n ,\n (1)\n\ny\n\n\n\n\n\n\n\n\n\nprevious model\n\n\n\n\nstructure prior\n so=f (s)\n\n\n\n\n\n\n\n   \n\n\n\n\n\n\n\nwhere Q(s) is the variational distribution to approximate the posterior of the noise transition matrix s,\nand Q(so) = Q(s) ds\nis the corresponding variational distribution of the structure so. Eq. (1)\ndso\nseamlessly uniﬁes previous models and structure instillation, remarked as the following beneﬁts.\n\nso=f (s)\n\n\n \n\nRemark 1 The ﬁrst term inside the expectation in Eq. (1) recovers the previous benchmark models,\nrepresenting the log-likelihood from x to the noisy label ˜y. The second term inside the expectation in\nEq. (1) is for structure instillation, reﬂecting the inconsistency between the distribution Q(so) learned\nfrom the training data and the structure prior P (so) provided by human cognition.\nAs a whole, MASKING model beneﬁts from the human guidance (the second term) in the procedure\nof learning with noisy supervisions (the ﬁrst term), which avoids the unexpected local minima with\nincorrect structures in previous works. Moreover, we avoid the difﬁculty of hyperparameter selection\nby deducing a Bayesian framework, which does not require the regularization parameter to be tuned.\n\nNote that human cognition may introduce uncertainty. In this case, we just focus on the certain\nknowledge and use this knowledge as the prior; on the other hand, we dispose the uncertain knowledge\nby Masking. A special case is when we do not have any transition knowledge, we can unmask the\nwhole matrix, i.e., allowing all possible transitions. This naturally degenerates our MASKING model\nto the unconstrained S-adapation method.\n 3.2.3 Towards principled realization\n\nTo realize the MASKING model, concretely, the second term in Eq. (1), we encounter two practical\nchallenges, and present the principled solutions as follows.\n\n3For the single-label classiﬁcation, a Categorical distribution is a natural choice. For the multi-label\n\nclassiﬁcation, a Multinomial distribution is used, since one example corresponds to multiple labels.\n 5\n\nChallenge from structure extraction: One challenge comes from how to specify the mapping\n) in Eq. (1), which extracts the structure variable so from the variable s. Without this step,\nfunction f (\n·\nwe cannot compute the structure variable so for Q(so) = Q(s) ds\n, and let alone optimize\ndso\nthe second term in Eq. (1). However, to the best of our knowledge, there is no related work that\nspeciﬁes f (\n\nso=f (s)\n\n\n\n\n) in the area of structure extraction.\n·\n\nHere, we explore a principled solution by simulating human cognition on the structure of the noise\ntransition matrix. In terms of the noise transition probability between two classes, human cognition\nconsiders the small value (i.e., 0.5%) as a sign of the invalid class transition, but the large value\n(i.e., 20%) as a noise pattern [14]. It indicates that, the larger transition probability is favored when\nquantifying the noise transition matrix into a structure. Such a procedure is very similar to the\nthresholding binarization operation with a tempered sigmoid function (Eq. (2)). Thus, we can use the\nfollowing tempered sigmoid function as f (\n·\n\n) to simulate the mapping from s to so,\n f (s) =\n\n1\n1 + exp(\n , where α\n (0, 1), β\n 1,\n \n ∈\n\ns−α\nβ )\n −\n (2)\n\nand we name its output f (s) as the masked structure so from s. By controlling the location parameter\nα and the scale parameter β, Eq. (2) quantiﬁes s into the structure so for the second term in Eq. (1).\nChallenge from structure alignment: The second term in Eq. (1) is to make the structure learned\nfrom the training data (represented by Q(so)), close to the human prior (represented by P (so)). We\nconsider it as structure alignment. The challenge here is how to specify the distributions P (so) and\nQ(so) in Eq. (1) to reasonably measure their divergence for the structure alignment. The smaller\ndivergence between P (so) and Q(so), the more similar they are.\nThis question is difﬁcult because, for prior P (so), we usually provide one or a few limited structure\ncandidates, and human cognition has the sparse empirical certainty [13] according to a speciﬁc noisy\ndata. That is to say, P (so) should be a distribution that concentrates on one or a few points, e.g.,\na multi-Dirac distribution or a multi-spike distribution4. These distributions are quite unstable for\noptimization, since they are approximately discrete, and easy to cause the computational overﬂow\nproblem [36]. Regarding Q(so), it is equal to specifying Q(s) since they are correlated by so = f (s).\nIf we ﬁnd Q(s) such that E\nQ(s) [ln Q(so)/P (so)] is analytically computable, we can avoid this\nchallenge. However, such a speciﬁcation with existing distributions is usually intractable.\n\nFortunately, we can employ the implicit models to deal with the above dilemma [42]. This is because\nin the implicit models, the distribution is directly simulated with neural networks plus a random noise,\nwhich avoids to specify an explicit distribution. Following this methodology, Q(s), Q(so) and P (so)\nin Eq. (1) can be implemented like Generative Adversarial Networks (GANs). Speciﬁcally, Q(s)\nand the divergence between Q(so) and P (so) are parameterized with two neural networks, i.e., one\ngenerator and one discriminator, and then play an adversarial game [12]. However, different from the\noriginal GANs, our model has one extra discriminator (called as reconstructor), since the ﬁrst term in\nEq. (1) involves s, which will act as the second discriminator during the game.\n\nConcretely, the corresponding implementation of each term in Eq. (1) is illustrated in Figure 3,\nconsisting of three modules, generator, discriminator and reconstructor. The generator is responsible\nfor generating a distribution Q(s) of the noise transition matrix s, which serves for both terms in\nEq. (1). The discriminator implements the function of the second term in Eq. (1) to measure the\ndifference\n(so, ˆso) between the extracted structure so with Eq. (2) and our prior structure ˆso. The\nx) and the noise\nreconstructor is for the ﬁrst term in Eq. (1), facilitating the classiﬁer prediction P (y\n|\ntransition matrix s to yield noisy labels ˜y. In this way, we instill the structure information from\nhuman cognition into an end-to-end model.\n M\n\n4 Related literature\n\nExcept several works mentioned before, we survey other solutions for noisy labels here. Statistical\nlearning focuses on theoretical guarantees, consisting of three directions - surrogate losses, noise rate\nestimation and probabilistic modeling. For example, in the surrogate losses, Natarajan et al. [31]\nproposed an unbiased estimator to provide the noise corrected loss approach. Masnadi-Shirazi et al.\n\n4https://en.wikipedia.org/wiki/Dirac_delta_function;\n\nhttps://en.wikipedia.org/\n wiki/Spike-and-slab_variable_selection\n 6\n\nFigure 3: A GAN-like structure to model the structure instillation on learning with noisy supervision.\n\n[27] presented a robust non-convex loss, which is the special case in a family of robust losses [16]. In\nnoise rate estimation, both Menon et al. [28] and Liu et al. [23] proposed a class-probability estimator\nusing order statistics on the range of scores. Sanderson et al. [38] presented the same estimator using\nthe slope of the ROC curve. In probabilistic modeling, Raykar et al. [33] proposed a two-coin model\nto handle noisy labels from multiple annotators. Yan et al. [47] extended this two-coin model by\nsetting the dynamic ﬂipping probability associated with samples.\n\nDeep learning acquires better performance due to its complex nonlinearity [19, 44, 17, 49]. For\nexample, Li et al. proposed a uniﬁed framework to distill the knowledge from clean labels and\nknowledge graph [22], which can be exploited to learn a better model from noisy labels. Veit et al.\ntrained a label cleaning network by a small set of clean labels, and used this network to reduce the\nnoise in large-scale noisy labels [43]. Tanaka et al. presented a joint optimization framework to learn\nparameters and estimate true labels simultaneously [40]. Ren et al. leveraged an additional validation\nset to adaptively assign weights to training examples in every iteration [35]. Rodrigues et al. added\na crowd layer after the output layer for noisy labels from multiple annotators [37]. However, all\nmethods require extra resources (e.g., knowledge graph or validation set) or more complex networks.\n\n5 Experiments\n\nIn this section, we verify the robustness of MASKING from two folds. First, we conduct experiments\non two benchmark datasets with three types of noise structure: namely (1) column-diagonal (Fig-\nure 1(a)); (2) tri-diagonal (Figure 1(b)); and (3) block-diagonal (Figure 1(c)). Second, we conduct\nexperiments on one industrial-level dataset with agnostic noise structure.\n\nBenchmark datasets. CIFAR-10 and CIFAR-100 datasets are used. Both datasets consist of 50k\n32 color image and its\nsamples for training and 10k samples for testing, where each sample is a 32\nlabel. For CIFAR-10, we randomly ﬂip the labels of the training set according to the ﬁrst two types of\nnoise structure, which has been illustrated in Figure 1 with predeﬁned transition probabilities. For\nCIFAR-100, we implement the similar procedure to generate the noisy data, but follow the last type of\nnoise structure in Figure 1(c). All predeﬁned transition probabilities are found in Table 2 (4th row).\n ×\n\nIndustrial-level dataset. An industrial-level dataset called Clothing1M [46] from online shopping\nwebsites (i.e., Taobao.com) is used here, where the ground-truth transition matrix is not available.\nClothing1M includes mislabeled images of different clothes, such as hoodie, jacket and windbreaker.\nThis dataset consist of 1000k samples for training and 1k samples for testing, where each sample\nis a 256\n256 color image and its label. Although we cannot know the accurate structure prior for\nClothing1M, we can distill an approximated structure from the pre-estimated transition matrix [46].\nWe consider the transition probabilities greater than 0.1 as the valid transition patterns, and the\ntransition probabilities smaller than 0.01 as the invalid transition patterns.\n ×\n\nBaselines and measurements. We compare MASKING with the state-of-the-art & the most related\ntechniques for noisy supervision: (1) forward correction [32] (F-correction) and (2) S-adaptation [10].\nWe also compare it with directly training deep networks on noisy data (marked as (3) NOISY) and\nclean data (marked as (4) CLEAN). The performance of CLEAN can be viewed as an oracle or an\nupper bound. The prediction accuracy is used to evaluate the classiﬁcation performance of each\nmodel in the test set. Besides, we qualitatively visualize the noise transition matrix when the training\nof each model converges, to analyze whether the true noise transition matrix is approached.\n\nImplementations. All experiments are conducted on a NVIDIA TITAN GPU, and all methods are\nimplemented by Tensorﬂow. We adopt the same base network as the classiﬁer of all methods, and\napply the cross-entropy loss for noisy labels. The stochastic gradient descent optimizer has been\nused to update the parameter of baselines and the classiﬁer in MASKING. For the generator and the\n 7\n\ndiscriminator, we follow the advice in Gulrajani et al. [15] to choose the RMSProp optimizer. For\nboth datasets, the batch size is set to 128 for 15,000 iterations. α and β in Eq. (2) are respectively set\n0.05 and 0.005. The estimation of the noise transition matrix in F-correction and the initialization of\nthe adaption layer in S-adaptation follow the strategy in Patrini et al. [32]. Note that we have tried the\noriginal initialization way in Goldberger and Ben-Reuven [10], but it is not better than the way in [32].\nMore details about the network architectures and the learning rates are summarized in Appendix B.\nOur implementation of MASKING is available at https://github.com/bhanML/Masking.\n\nEmpirical results. We train MASKING and baselines (except CLEAN) on the noisy datasets and\nvalidate the performance in the clean test datasets. Figure 4 depicts the test accuracy on benchmark\ndatasets with three types of noise transition matrix. According to the comparison, we can ﬁnd that\nMASKING persistently outperforms F-correction, S-adaptation and NOISY. In terms of tri-diagonal\nand block-diagonal cases, it almost achieves the performance comparable to that of CLEAN.\n\nBesides, Table 2 presents the visualization of the noise transition matrix estimated by F-correction,\nS-adaptation and MASKING, as well as the true noise transition matrix. As can be seen, with the\nguidance of the prior structure, MASKING infers the noise transition matrix better than two baselines.\nSpeciﬁcally, we observe that for the estimation on the tri-diagonal structure, both F-correction and\nS-adaptation severely fail. F-correction pre-estimates a non-ideal matrix, and S-adaptation tunes it\nworse, while MASKING learns it better. To avoid the performance drop when directly training on the\nnoisy dataset as [19, 3], we have conﬁgured the dropout layer in deep neural networks as [3].\n (a) Column-diagnoal (CIFAR-10)\n (b) Tri-diagnoal (CIFAR-10)\n (c) Block-diagnoal (CIFAR-100)\n Figure 4: Test accuracy vs iterations on benchmark datasets with three types of noise structure.\n Table 1: Test accuracy on Clothing1M with agnostic noise structure.\n Models\n Performance(%)\n\nNOISY\nF-correction\nS-adaptation\nMASKING\n CLEAN\n\n68.9\n69.8\n70.3\n71.1\n 75.2\n\nFurthermore, test accuracy of all methods on Clothing1M dataset is shown in Table 1. The comparison\ndenotes that, when the noise model of the training data is completely unknown to all methods,\nMASKING still outperforms other methods. Compared to results in Figure 4, the robustness of\nMASKING marginally outperforms that of F-correction and S-adaptation. We conjecture two reasons\nexist: First, the structure prior we used here is not the ground-truth noise structure. Second, the\nground-truth noise structure of Clothing1M is too complex to be estimated easily. To solve the\nestimation issue, we can use crowdsourcing to provide labels in practice, and invite an expert to ﬁnd\nthe accurate noise structure. This should be much cheaper than letting the expert assign labels.\n\n6 Conclusions\n\nThis paper presents a Masking approach. This approach conveys human cognition of invalid class\ntransitions, and speculates the structure of the noise transition matrix. Given the structure information,\n 8\n\nTable 2: The estimation of the noise transition matrix by F-correction (1st row), S-adaptation (2nd\nrow) and MASKING (3rd row), and the truth (4th row) in the case of three types of noise transition\nstructure: column-diagonal (1st column), tri-diagonal (2nd column), block-diagonal (3rd column).\n\nwe derive a structure-aware probabilistic model (MASKING), which incorporates a structure prior.\nEmpirical results demonstrate that our approach can improve the robustness of classiﬁers obviously.\nIn future, we will explore how MASKING self-corrects the incorrect noise structure. Namely, when\nthe noise structure is wrongly set at the initial stage, how does our model correct the initial structure\nby learning from the ﬁnite dataset?\n Acknowledgments.\n\nMS was supported by the International Research Center for Neurointelligence (WPI-IRCN) at The\nUniversity of Tokyo Institutes for Advanced Study. IWT was supported by ARC FT130100746,\nDP180100106 and LP150100671. MZ acknowledges the support of Award IIS-1812699 from the U.S.\nNational Science Foundation. YZ was supported by the High Technology Research and Development\nProgram of China (2015AA015801), NSFC (61521062), and STCSM (18DZ2270700). BH would\nlike to thank the ﬁnancial support from RIKEN-AIP. JY would like to thank the ﬁnancial support\nSJTU-CMIC and UTS-CAI. We gratefully acknowledge the support of NVIDIA Corporation with\nthe donation of the Titan Xp GPU used for this research.\n 9\n\nReferences\n\n[1] Y. Aït-Sahalia, J. Fan, and D. Xiu. High-frequency covariance estimates with noisy and asynchronous\n ﬁnancial data. Journal of the American Statistical Association, 105(492):1504–1517, 2010.\n [2] D. Angluin and P. Laird. Learning from noisy examples. Machine Learning, 2(4):343–370, 1988.\n [3] D. Arpit, S. Jastrz˛ebski, N. Ballas, D. Krueger, E. Bengio, M. Kanwal, T. Maharaj, A. Fischer, A. Courville,\n and Y. Bengio. A closer look at memorization in deep networks. In ICML, 2017.\n [4] S. Azadi, J. Feng, S. Jegelka, and T. Darrell. Auxiliary image regularization for deep cnns with noisy\n labels. In ICLR, 2016.\n\n[5] M. Belkin, P. Niyogi, and V. Sindhwani. Manifold regularization: A geometric framework for learning\nfrom labeled and unlabeled examples. Journal of Machine Learning Research, 7(Nov):2399–2434, 2006.\n [6] Y. Cha and J. Cho. Social-network analysis using topic models. In SIGIR, 2012.\n [7] J. Deng, J. Krause, and L. Fei-Fei. Fine-grained crowdsourcing for ﬁne-grained recognition. In CVPR,\n 2013.\n [8] Y. Dgani, H. Greenspan, and J. Goldberger. Training a neural network based on unreliable human annotation\n of medical images. In ISBI, 2018.\n [9] P. Domingos and M. Pazzani. On the optimality of the simple bayesian classiﬁer under zero-one loss.\n Machine Learning, 29(2-3):103–130, 1997.\n [10] J. Goldberger and E. Ben-Reuven. Training deep neural-networks using a noise adaptation layer. In ICLR,\n 2017.\n [11] I. Goodfellow, Y. Bengio, and A. Courville. Deep Learning. MIT Press, 2016.\n [12] I. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu, D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio.\n Generative adversarial nets. In NIPS, 2014.\n [13] N. Goodman. Sense and certainty. The Philosophical Review, pages 160–167, 1952.\n [14] P. Grigolini, G. Aquino, M. Bologna, M. Lukovi´c, and B. West. A theory of 1/f noise in human cognition.\n Physica A: Statistical Mechanics and its Applications, 388(19):4192–4204, 2009.\n [15] I. Gulrajani, F. Ahmed, M. Arjovsky, V. Dumoulin, and A. Courville. Improved training of wasserstein\n gans. In NIPS, 2017.\n [16] B. Han, I. Tsang, and L. Chen. On the convergence of a family of robust losses for stochastic gradient\n descent. In ECML-PKDD, 2016.\n [17] D. Hendrycks, M. Mazeika, D. Wilson, and K. Gimpel. Using trusted data to train deep networks on labels\n corrupted by severe noise. In NIPS, 2018.\n [18] J. Huang, A. Gretton, K. Borgwardt, B. Schölkopf, and A. Smola. Correcting sample selection bias by\n unlabeled data. In NIPS, 2007.\n [19] L. Jiang, Z. Zhou, T. Leung, L. Li, and L. Fei-Fei. Mentornet: Learning data-driven curriculum for very\n deep neural networks on corrupted labels. In ICML, 2018.\n [20] S. Laine and T. Aila. Temporal ensembling for semi-supervised learning. In ICLR, 2017.\n [21] W. Li, L. Wang, W. Li, E. Agustsson, and L. Van Gool. Webvision database: Visual learning and\n understanding from web data. arXiv:1708.02862, 2017.\n [22] Y. Li, J. Yang, Y. Song, L. Cao, J. Luo, and J. Li. Learning from noisy labels with distillation. In ICCV,\n 2017.\n [23] T. Liu and D. Tao. Classiﬁcation with noisy labels by importance reweighting. IEEE Transactions on\n Pattern Analysis and Machine Intelligence, 38(3):447–461, 2016.\n [24] W. Liu, Y. Jiang, J. Luo, and S. Chang. Noise resistant graph ranking for improved web image search. In\n CVPR, 2011.\n [25] X. Ma, Y. Wang, M. Houle, S. Zhou, S. Erfani, S. Xia, S. Wijewickrema, and J. Bailey. Dimensionality-\n driven learning with noisy labels. In ICML, 2018.\n 10\n\n[26] E. Malach and S. Shalev-Shwartz. Decoupling\" when to update\" from\" how to update\". In NIPS, 2017.\n [27] H. Masnadi-Shirazi and N. Vasconcelos. On the design of loss functions for classiﬁcation:\n theory,\n robustness to outliers, and savageboost. In NIPS, 2009.\n [28] A. Menon, B. Van Rooyen, C. Ong, and B. Williamson. Learning from corrupted binary labels via\n class-probability estimation. In ICML, 2015.\n [29] R. Michalski, J. Carbonell, and T. Mitchell. Machine Learning: An Artiﬁcial Intelligence Approach.\n Springer Science & Business Media, 2013.\n [30] T. Miyato, S. Maeda, M. Koyama, and S. Ishii. Virtual adversarial training: A regularization method for\n supervised and semi-supervised learning. ICLR, 2016.\n [31] N. Natarajan, I. Dhillon, P. Ravikumar, and A. Tewari. Learning with noisy labels. In NIPS, 2013.\n [32] G. Patrini, A. Rozza, A. Menon, R. Nock, and L. Qu. Making deep neural networks robust to label noise:\n A loss correction approach. In CVPR, 2017.\n [33] V. Raykar, S. Yu, L. Zhao, G. Valadez, C. Florin, L. Bogoni, and L. Moy. Learning from crowds. Journal\n of Machine Learning Research, 11(Apr):1297–1322, 2010.\n [34] S. Reed, H. Lee, D. Anguelov, C. Szegedy, D. Erhan, and A. Rabinovich. Training deep neural networks\n on noisy labels with bootstrapping. In ICLR, 2015.\n [35] M. Ren, W. Zeng, B. Yang, and R. Urtasun. Learning to reweight examples for robust deep learning. In\n ICML, 2018.\n [36] V. Rockova and K. McAlinn. Dynamic variable selection with Spike-and-Slab process priors.\n arXiv:1708.00085, 2017.\n [37] F. Rodrigues and F. Pereira. Deep learning from crowds. In AAAI, 2018.\n [38] T. Sanderson and C. Scott. Class proportion estimation with application to multiclass anomaly rejection.\n In AISTATS, 2014.\n [39] S. Sukhbaatar, J. Bruna, M. Paluri, L. Bourdev, and R. Fergus. Training convolutional networks with noisy\n labels. In ICLR workshop, 2015.\n [40] D. Tanaka, D. Ikami, T. Yamasaki, and K. Aizawa. Joint optimization framework for learning with noisy\n labels. In CVPR, 2018.\n [41] A. Tarvainen and H. Valpola. Mean teachers are better role models: Weight-averaged consistency targets\n improve semi-supervised deep learning results. In NIPS, 2017.\n [42] D. Tran, R. Ranganath, and D. Blei. Hierarchical implicit models and likelihood-free variational inference.\n In NIPS, 2017.\n [43] A. Veit, N. Alldrin, G. Chechik, I. Krasin, A. Gupta, and S. Belongie. Learning from noisy large-scale\n datasets with minimal supervision. In CVPR, 2017.\n [44] Y. Wang, W. Liu, X. Ma, J. Bailey, H. Zha, L. Song, and S. Xia. Iterative learning with open-set noisy\n labels. In CVPR, 2018.\n [45] P. Welinder, S. Branson, P. Perona, and S. Belongie. The multidimensional wisdom of crowds. In NIPS,\n 2010.\n [46] T. Xiao, T. Xia, Y. Yang, C. Huang, and X. Wang. Learning from massive noisy labeled data for image\n classiﬁcation. In CVPR, 2015.\n [47] Y. Yan, R. Rosales, G. Fung, R. Subramanian, and J. Dy. Learning from multiple annotators with varying\n expertise. Machine Learning, 95(3):291–327, 2014.\n [48] C. Zhang, S. Bengio, M. Hardt, B. Recht, and O. Vinyals. Understanding deep learning requires rethinking\n generalization. In ICLR, 2017.\n [49] Z. Zhang and M. Sabuncu. Generalized cross entropy loss for training deep neural networks with noisy\n labels. In NIPS, 2018.\n 11\n", "metadata": {"source": "C:\\Users\\33380\\AppData\\Local\\Temp\\gradio\\909df94e854551a3c85778806c7b23185d76137ad9ce10d1f1184f30dbcd4599\\NeurIPS-2018-masking-a-new-perspective-of-noisy-supervision-Paper.pdf", "title": "NeurIPS-2018-masking-a-new-perspective-of-noisy-supervision-Paper.pdf", "chunk_id": 0}, "token": 10330}], "title": "NeurIPS-2018-masking-a-new-perspective-of-noisy-supervision-Paper.pdf"}